<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Slum Dwellers - Profile</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <!-- Reuse dashboard styles for layout and sidebar -->
  <link rel="stylesheet" href="./dashboard.css" />
  <!-- Profile-specific styles -->
  <link rel="stylesheet" href="./profile.css" />
  <!-- Shared QR modal/generator -->
  <script src="./qr.js"></script>
  <!-- Shared Logout modal -->
  <script src="./logout.js"></script>
</head>
<body>
  <div class="dashboard-layout">
   <aside class="sidebar">
  <div class="brand" aria-label="SLUMLINK Brand">
    <img
      src="/src/images/slum Logo.png"
      alt="SlumLink Logo"
      class="logo-mark"
    />
    <span class="logo-text">SLUMLINK</span>
  </div>

  <nav class="nav">
    <button
      class="nav-btn"
      data-target="#dashboard"
      onclick="window.location.href='./dashboard.html'">
      Dashboard
    </button>

    <button
      class="nav-btn active"
      data-target="#profile"
      aria-current="page">
      Profile
    </button>

    <button
      class="nav-btn"
      data-target="#submit-complaint"
      onclick="window.location.href='./create-complaint.html'">
      Submit Complaint
    </button>

    <button class="nav-btn" data-target="#complaint-status">
      Complaint Status
    </button>

    <button class="nav-btn" data-target="#aid-services">
      Aid and Services
    </button>

    <button class="nav-btn" data-target="#qr-code">
      QR Code
    </button>

    <button class="nav-btn" data-target="#logout">
      Logout
    </button>
  </nav>
</aside>
    <main class="content">
      <section class="content-body">
        

        <!-- Tabs navigation -->
        <div class="profile-tabs" role="tablist" aria-label="Profile Sections">
          <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="tab-personal" id="tab-btn-personal" data-tab="personal">Personal Information</button>
          <button class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-marital" id="tab-btn-marital" data-tab="marital">Marital Information</button>
          <button class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-children" id="tab-btn-children" data-tab="children">Children Information</button>
        </div>

        <!-- Tab panels -->
        <section class="tab-content" id="tab-personal" role="tabpanel" aria-labelledby="tab-btn-personal">
          <div class="panel-card">
            <div class="panel-header">
              <div class="panel-title">Personal Information</div>
              <div class="panel-actions">
                <button id="editProfileBtn" class="btn primary" type="button">Edit Profile</button>
                <button id="editMemberBtn" class="btn primary" type="button">Edit Member</button>
                <button id="changePhoneBtn" class="btn outlined" type="button">Change Phone Number</button>
                <button id="saveProfileBtn" class="btn primary" type="button" hidden>Save</button>
                <button id="cancelEditBtn" class="btn outlined" type="button" hidden>Cancel</button>
                <button id="changePasswordBtn" class="btn outlined" type="button">Change Password</button>
              </div>
            </div>
            <div class="info-grid">
              <div class="info-row" data-field="full_name" data-editable="true"><span class="info-key">Full Name</span><span class="info-val">Hasan Mia</span></div>
              <div class="info-row" data-field="mobile" data-editable="false"><span class="info-key">Phone Number</span><span class="info-val">+8801701513788</span></div>
              <div class="info-row" data-field="gender" data-editable="false"><span class="info-key">Gender</span><span class="info-val">Male</span></div>
              <div class="info-row" data-field="dob" data-editable="false"><span class="info-key">Date of Birth</span><span class="info-val">12 Jan 1988</span></div>
              <div class="info-row" data-field="occupation" data-editable="true"><span class="info-key">Occupation</span><span class="info-val">Day Laborer</span></div>
              <div class="info-row" data-field="education" data-editable="true"><span class="info-key">Education</span><span class="info-val">Secondary School (SSC)</span></div>
              <div class="info-row" data-field="income" data-editable="true" data-type="select"><span class="info-key">Income Range</span><span class="info-val">5001-9999</span></div>
              <div class="info-row" data-field="division" data-editable="true"><span class="info-key">Division</span><span class="info-val">Dhaka</span></div>
              <div class="info-row" data-field="family_members" data-editable="true"><span class="info-key">Family Members</span><span class="info-val">4</span></div>
            </div>
          </div>
        </section>

        <section class="tab-content" id="tab-marital" role="tabpanel" aria-labelledby="tab-btn-marital" hidden>
          <div class="panel-card">
            <div class="panel-title">Marital Information</div>
            <div class="spouse-list">
              <!-- Spouse Card 1 -->
              <div class="spouse-card" data-spouse-index="0" data-spouse-id="1">
                <div class="spouse-header">
                  <div class="spouse-name">Ayesha Begum</div>
                  <div class="card-actions">
                    <button class="btn primary edit-spouse-btn" type="button">Edit Profile</button>
                    <button class="btn outlined change-spouse-phone-btn" type="button" data-spouse-id="1">Change Phone Number</button>
                    <button class="btn primary save-spouse-btn" type="button" hidden>Save</button>
                    <button class="btn outlined cancel-spouse-btn" type="button" hidden>Cancel</button>
                  </div>
                </div>
                <div class="info-grid">
                  <div class="info-row" data-field="name" data-editable="false"><span class="info-key">Name</span><span class="info-val">Ayesha Begum</span></div>
                  <div class="info-row" data-field="dob" data-editable="false"><span class="info-key">Date of Birth</span><span class="info-val">05 Mar 1990</span></div>
                  <div class="info-row" data-field="gender" data-editable="false"><span class="info-key">Gender</span><span class="info-val">Female</span></div>
                  <div class="info-row" data-field="mobile" data-editable="false"><span class="info-key">Phone Number</span><span class="info-val">+8801701513799</span></div>
                  <div class="info-row" data-field="education" data-editable="true"><span class="info-key">Education</span><span class="info-val">Primary School</span></div>
                  <div class="info-row" data-field="job" data-editable="true"><span class="info-key">Occupation</span><span class="info-val">Home Maker</span></div>
                  <div class="info-row" data-field="income" data-editable="true" data-type="select"><span class="info-key">Income Range</span><span class="info-val">—</span></div>
                </div>
              </div>

              
            </div>
          </div>
        </section>

        <section class="tab-content" id="tab-children" role="tabpanel" aria-labelledby="tab-btn-children" hidden>
          <div class="panel-card">
            <div class="panel-title">Children Information</div>
            <div class="children-list">
              <!-- Child Card 1 -->
              <div class="child-card" data-child-index="0" data-child-id="1">
                <div class="child-header">
                  <div class="child-name">Rafi Ali</div>
                  <div class="card-actions">
                    <button class="btn primary edit-child-btn" type="button">Edit Profile</button>
                    <button class="btn primary save-child-btn" type="button" hidden>Save</button>
                    <button class="btn outlined cancel-child-btn" type="button" hidden>Cancel</button>
                  </div>
                </div>
                <div class="info-grid">
                  <div class="info-row" data-field="name" data-editable="false"><span class="info-key">Name</span><span class="info-val">Rafi Ali</span></div>
                  <div class="info-row" data-field="dob" data-editable="false"><span class="info-key">Date of Birth</span><span class="info-val">15 Feb 2016</span></div>
                  <div class="info-row" data-field="education" data-editable="true"><span class="info-key">Education</span><span class="info-val">Primary School</span></div>
                  <div class="info-row" data-field="job" data-editable="true"><span class="info-key">Occupation</span><span class="info-val">Student</span></div>
                  <div class="info-row" data-field="income" data-editable="true" data-type="select"><span class="info-key">Income Range</span><span class="info-val">—</span></div>
                  <div class="info-row" data-field="preferred_job" data-editable="true"><span class="info-key">Preferred Job</span><span class="info-val">Engineer</span></div>
                </div>
              </div>

              <!-- Child Card 2 -->
              <div class="child-card" data-child-index="1" data-child-id="2">
                <div class="child-header">
                  <div class="child-name">Sara Khatun</div>
                  <div class="card-actions">
                    <button class="btn primary edit-child-btn" type="button">Edit Profile</button>
                    <button class="btn primary save-child-btn" type="button" hidden>Save</button>
                    <button class="btn outlined cancel-child-btn" type="button" hidden>Cancel</button>
                  </div>
                </div>
                <div class="info-grid">
                  <div class="info-row" data-field="name" data-editable="false"><span class="info-key">Name</span><span class="info-val">Sara Khatun</span></div>
                  <div class="info-row" data-field="dob" data-editable="false"><span class="info-key">Date of Birth</span><span class="info-val">22 Sep 2020</span></div>
                  <div class="info-row" data-field="education" data-editable="true"><span class="info-key">Education</span><span class="info-val">Nursery</span></div>
                  <div class="info-row" data-field="job" data-editable="true"><span class="info-key">Occupation</span><span class="info-val">—</span></div>
                  <div class="info-row" data-field="income" data-editable="true" data-type="select"><span class="info-key">Income Range</span><span class="info-val">—</span></div>
                  <div class="info-row" data-field="preferred_job" data-editable="true"><span class="info-key">Preferred Job</span><span class="info-val">Doctor</span></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </section>
    </main>
  </div>

  <!-- Change Password Modal -->
  <div id="changePasswordModal" class="modal-overlay" hidden>
    <div class="modal-box">
      <div class="modal-header">
        <h2 class="modal-title">Change Password</h2>
        <button class="modal-close" id="closePasswordModal" aria-label="Close">&times;</button>
      </div>
      <form id="changePasswordForm" class="modal-form">
        <div class="modal-field">
          <label for="currentPassword"><span>Current Password</span></label>
          <input type="password" name="currentPassword" id="currentPassword" required placeholder="Enter current password" />
          <label class="view-password-label">
            <input type="checkbox" class="view-pwd-checkbox" data-target="currentPassword" />
            <span>View Password</span>
          </label>
        </div>
        <div class="modal-field">
          <label for="newPassword"><span>New Password</span></label>
          <input type="password" name="newPassword" id="newPassword" required placeholder="Enter new password" />
          <label class="view-password-label">
            <input type="checkbox" class="view-pwd-checkbox" data-target="newPassword" />
            <span>View Password</span>
          </label>
        </div>
        <div class="modal-field">
          <label for="confirmPassword"><span>Confirm New Password</span></label>
          <input type="password" name="confirmPassword" id="confirmPassword" required placeholder="Confirm new password" />
          <label class="view-password-label">
            <input type="checkbox" class="view-pwd-checkbox" data-target="confirmPassword" />
            <span>View Password</span>
          </label>
        </div>
        <div class="modal-error" id="passwordError" hidden></div>
        <div class="modal-success" id="passwordSuccess" hidden></div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="cancelPasswordBtn">Cancel</button>
          <button type="submit" class="btn primary">Save Password</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Edit Member Modal -->
  <div id="editMemberModal" class="modal-overlay" hidden>
    <div class="modal-box modal-box-lg">
      <div class="modal-header">
        <h2 class="modal-title">Edit Family Members</h2>
        <button class="modal-close" id="closeEditMemberModal" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body-scroll">
        <form id="editMemberForm" class="modal-form">
          <p class="modal-question">Do you want to add or remove Family Members?</p>
          <div class="modal-field">
            <label for="memberAction"><span>Select Action</span></label>
            <select id="memberAction" name="memberAction" class="modal-select">
              <option value="" disabled selected>Select an option</option>
              <option value="add">Add Members</option>
              <option value="remove">Remove Members</option>
            </select>
          </div>

          <!-- Remove Members Section (hidden by default) -->
          <div id="removeMembersSection" class="remove-members-section" hidden>
            <!-- Spouse Removal Section -->
            <div class="removal-category">
              <h3 class="removal-title">Spouse Removal</h3>
              <div class="modal-field">
                <label for="spouseRemoveCount"><span>Number of Spouse to Remove</span></label>
                <select id="spouseRemoveCount" name="spouseRemoveCount" class="modal-select">
                  <option value="0" selected>0</option>
                </select>
              </div>
              <div id="spouseRemovalForms" class="removal-forms"></div>
            </div>

            <!-- Children Removal Section -->
            <div class="removal-category">
              <h3 class="removal-title">Children Removal</h3>
              <div class="modal-field">
                <label for="childrenRemoveCount"><span>Number of Children to Remove</span></label>
                <select id="childrenRemoveCount" name="childrenRemoveCount" class="modal-select">
                  <option value="0" selected>0</option>
                </select>
              </div>
              <div id="childrenRemovalForms" class="removal-forms"></div>
            </div>
          </div>

          <!-- Add Members Section (hidden by default) -->
          <div id="addMembersSection" class="add-members-section" hidden>
            <!-- Add Spouse Section -->
            <div class="add-category">
              <h3 class="add-title">Add Spouse</h3>
              <div class="modal-field">
                <label for="spouseAddCount"><span>Number of Spouse to Add</span></label>
                <input type="number" id="spouseAddCount" name="spouseAddCount" class="modal-input" min="0" max="10" value="0" />
              </div>
              <div id="spouseAddForms" class="add-forms"></div>
            </div>

            <!-- Add Children Section -->
            <div class="add-category">
              <h3 class="add-title">Add Children</h3>
              <div class="modal-field">
                <label for="childrenAddCount"><span>Number of Children to Add</span></label>
                <input type="number" id="childrenAddCount" name="childrenAddCount" class="modal-input" min="0" value="0" />
              </div>
              <div id="childrenAddForms" class="add-forms"></div>
            </div>
          </div>

          <div class="modal-error" id="memberError" hidden></div>
          <div class="modal-actions">
            <button type="button" class="btn outlined" id="cancelEditMemberBtn">Cancel</button>
            <button type="submit" class="btn primary">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div class="modal-overlay" id="confirmationModal" hidden>
    <div class="modal-box confirmation-modal-box">
      <div class="modal-header">
        <h2>Confirm Submission</h2>
        <button type="button" class="modal-close" id="closeConfirmationModal" aria-label="Close">&times;</button>
      </div>
      <div class="confirmation-content">
        <p>Are you sure you want to submit this application?</p>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn outlined" id="cancelConfirmationBtn">Cancel</button>
        <button type="button" class="btn primary" id="confirmSubmitBtn">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Phone Number Change Modal -->
  <div id="phoneChangeModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      
      <!-- Step 1: Confirmation Dialog -->
      <div id="phoneChangeStep1" class="phone-change-step">
        <div class="modal-header">
          <h3>Change Phone Number</h3>
          <button type="button" class="close-btn" id="closePhoneChangeModal">&times;</button>
        </div>
        <div class="modal-body">
          <p>Do you want to change your phone number?</p>
          <p class="text-warning">This action will require verification of both your current and new phone numbers.</p>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="phoneChangeCancelBtn">No</button>
          <button type="button" class="btn primary" id="phoneChangeConfirmBtn">Yes</button>
        </div>
      </div>

      <!-- Step 2: Current Phone OTP Verification -->
      <div id="phoneChangeStep2" class="phone-change-step" style="display: none;">
        <div class="modal-header">
          <h3>Verify Current Phone</h3>
          <button type="button" class="close-btn" id="closePhoneChangeModal2">&times;</button>
        </div>
        <div class="modal-body">
          <p>We've sent an OTP to your current phone number <strong id="currentPhoneMasked"></strong></p>
          <div class="form-group">
            <label for="currentPhoneOTP">Enter OTP:</label>
            <input type="text" id="currentPhoneOTP" class="form-control" placeholder="Enter 6-digit OTP" maxlength="6">
            <div id="currentOtpError" class="error-message" style="display: none;"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="backToStep1Btn">Back</button>
          <button type="button" class="btn primary" id="verifyCurrentOtpBtn">Verify OTP</button>
        </div>
      </div>

      <!-- Step 3: New Phone Number Entry -->
      <div id="phoneChangeStep3" class="phone-change-step" style="display: none;">
        <div class="modal-header">
          <h3>Enter New Phone Number</h3>
          <button type="button" class="close-btn" id="closePhoneChangeModal3">&times;</button>
        </div>
        <div class="modal-body">
          <p>Current phone verification successful! Please enter your new phone number.</p>
          <div class="form-group">
            <label for="newPhoneNumber">New Phone Number:</label>
            <input type="tel" id="newPhoneNumber" class="form-control" placeholder="01xxxxxxxxx" maxlength="11">
            <small class="form-help">Enter 11 digits only (e.g., 01701234567)</small>
            <div id="newPhoneError" class="error-message" style="display: none;"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="backToStep2Btn">Back</button>
          <button type="button" class="btn primary" id="sendNewPhoneOtpBtn">Send OTP</button>
        </div>
      </div>

      <!-- Step 4: New Phone OTP Verification -->
      <div id="phoneChangeStep4" class="phone-change-step" style="display: none;">
        <div class="modal-header">
          <h3>Verify New Phone</h3>
          <button type="button" class="close-btn" id="closePhoneChangeModal4">&times;</button>
        </div>
        <div class="modal-body">
          <p>We've sent an OTP to your new phone number <strong id="newPhoneMasked"></strong></p>
          <div class="form-group">
            <label for="newPhoneOTP">Enter OTP:</label>
            <input type="text" id="newPhoneOTP" class="form-control" placeholder="Enter 6-digit OTP" maxlength="6">
            <div id="newOtpError" class="error-message" style="display: none;"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="backToStep3Btn">Back</button>
          <button type="button" class="btn primary" id="verifyNewOtpBtn">Verify & Update</button>
        </div>
      </div>

    </div>
  </div>

  <!-- Spouse Phone Number Change Modal -->
  <div id="spousePhoneChangeModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      
      <!-- Step 1: Confirmation Dialog -->
      <div id="spousePhoneChangeStep1" class="phone-change-step">
        <div class="modal-header">
          <h3>Change Spouse Phone Number</h3>
          <button type="button" class="close-btn" id="closeSpousePhoneChangeModal">&times;</button>
        </div>
        <div class="modal-body">
          <p>Do you want to change the phone number for <strong id="spouseNameForChange"></strong>?</p>
          <p class="text-warning">This action will require verification of both the current and new phone numbers.</p>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="spousePhoneChangeCancelBtn">No</button>
          <button type="button" class="btn primary" id="spousePhoneChangeConfirmBtn">Yes</button>
        </div>
      </div>

      <!-- Step 2: Current Phone OTP Verification -->
      <div id="spousePhoneChangeStep2" class="phone-change-step" style="display: none;">
        <div class="modal-header">
          <h3>Verify Current Phone</h3>
          <button type="button" class="close-btn" id="closeSpousePhoneChangeModal2">&times;</button>
        </div>
        <div class="modal-body">
          <p>We've sent an OTP to the current phone number <strong id="spouseCurrentPhoneMasked"></strong></p>
          <div class="form-group">
            <label for="spouseCurrentPhoneOTP">Enter OTP:</label>
            <input type="text" id="spouseCurrentPhoneOTP" class="form-control" placeholder="Enter 6-digit OTP" maxlength="6">
            <div id="spouseCurrentOtpError" class="error-message" style="display: none;"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="spouseBackToStep1Btn">Back</button>
          <button type="button" class="btn primary" id="spouseVerifyCurrentOtpBtn">Verify OTP</button>
        </div>
      </div>

      <!-- Step 3: New Phone Number Entry -->
      <div id="spousePhoneChangeStep3" class="phone-change-step" style="display: none;">
        <div class="modal-header">
          <h3>Enter New Phone Number</h3>
          <button type="button" class="close-btn" id="closeSpousePhoneChangeModal3">&times;</button>
        </div>
        <div class="modal-body">
          <p>Current phone verification successful! Please enter the new phone number.</p>
          <div class="form-group">
            <label for="spouseNewPhoneNumber">New Phone Number:</label>
            <input type="tel" id="spouseNewPhoneNumber" class="form-control" placeholder="01xxxxxxxxx" maxlength="11">
            <small class="form-help">Enter 11 digits only (e.g., 01701234567)</small>
            <div id="spouseNewPhoneError" class="error-message" style="display: none;"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="spouseBackToStep2Btn">Back</button>
          <button type="button" class="btn primary" id="spouseSendNewPhoneOtpBtn">Send OTP</button>
        </div>
      </div>

      <!-- Step 4: New Phone OTP Verification -->
      <div id="spousePhoneChangeStep4" class="phone-change-step" style="display: none;">
        <div class="modal-header">
          <h3>Verify New Phone</h3>
          <button type="button" class="close-btn" id="closeSpousePhoneChangeModal4">&times;</button>
        </div>
        <div class="modal-body">
          <p>We've sent an OTP to the new phone number <strong id="spouseNewPhoneMasked"></strong></p>
          <div class="form-group">
            <label for="spouseNewPhoneOTP">Enter OTP:</label>
            <input type="text" id="spouseNewPhoneOTP" class="form-control" placeholder="Enter 6-digit OTP" maxlength="6">
            <div id="spouseNewOtpError" class="error-message" style="display: none;"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn outlined" id="spouseBackToStep3Btn">Back</button>
          <button type="button" class="btn primary" id="spouseVerifyNewOtpBtn">Verify & Update</button>
        </div>
      </div>

    </div>
  </div>

  <script src="./profile.js"></script>
</body>
</html>
